(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{21:function(e,t,n){},24:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(10),r=(n(19),n(20),n(21),n(6)),s=n(2),i=n(3),l=n.n(i),u="https://mate.academy/students-api";function d(e){return new Promise((function(t){setTimeout(t,e)}))}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a={method:t};return n&&(a.body=JSON.stringify(n),a.headers={"Content-Type":"application/json; charset=UTF-8"}),d(300).then((function(){return fetch(u+e,a)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var b,f=function(e){return j(e)},p=function(e,t){return j(e,"POST",t)},h=function(e,t){return j(e,"PATCH",t)},m=function(e){return j(e,"DELETE")},O=n(4),x=n.n(O),v=n(5),g=function(){var e=Object(v.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(v.a)(x.a.mark((function e(t){var n,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,a=t.name,e.abrupt("return",p("/users",{email:n,name:a}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=n(0),T=function(e){var t=e.onLogin,n=Object(a.useState)(""),c=Object(s.a)(n,2),o=c[0],r=c[1],i=Object(a.useState)(""),u=Object(s.a)(i,2),d=u[0],j=u[1],b=Object(a.useState)(!1),f=Object(s.a)(b,2),p=f[0],h=f[1],m=Object(a.useState)(!1),O=Object(s.a)(m,2),T=O[0],k=O[1],_=Object(a.useState)(""),S=Object(s.a)(_,2),C=S[0],L=S[1],E=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e)};Object(a.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(a){}}),[]);var w=function(){var e=Object(v.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(o);case 2:(t=e.sent)?E(t):h(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(v.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),L(""),k(!0),e.prev=3,!p){e.next=9;break}return e.next=7,y({name:d,email:o}).then(E);case 7:e.next=11;break;case 9:return e.next=11,w();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),L("Something went wrtong");case 16:return e.prev=16,k(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(N.jsxs)("form",{onSubmit:D,className:"box mt-5",children:[Object(N.jsx)("h1",{className:"title is-3",children:p?"You need to register":"Log in to open todos"}),Object(N.jsxs)("div",{className:"field",children:[Object(N.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(N.jsxs)("div",{className:l()("control has-icons-left",{"is-loading":T}),children:[Object(N.jsx)("input",{type:"email",id:"user-email",className:l()("input",{"is-danger":!p&&C}),placeholder:"Enter your email",disabled:T||p,value:o,required:!0,onChange:function(e){return r(e.target.value)}}),Object(N.jsx)("span",{className:"icon is-small is-left",children:Object(N.jsx)("i",{className:"fas fa-envelope"})})]}),!p&&C&&Object(N.jsx)("p",{className:"help is-danger",children:C})]}),p&&Object(N.jsxs)("div",{className:"field",children:[Object(N.jsx)("label",{className:"label",htmlFor:"user-name",children:"Your Name"}),Object(N.jsxs)("div",{className:l()("control has-icons-left",{"is-loading":T}),children:[Object(N.jsx)("input",{type:"text",id:"user-name",className:l()("input",{"is-danger":p&&C}),placeholder:"Enter your name",required:!0,minLength:4,disabled:T,value:d,onChange:function(e){return j(e.target.value)}}),Object(N.jsx)("span",{className:"icon is-small is-left",children:Object(N.jsx)("i",{className:"fas fa-user"})})]}),p&&C&&Object(N.jsx)("p",{className:"help is-danger",children:C})]}),Object(N.jsx)("div",{className:"field",children:Object(N.jsx)("button",{type:"submit",className:l()("button is-primary",{"is-loading":T}),children:p?"Register":"Login"})})]})},k=c.a.createContext(null),_=function(e){var t=e.children,n=Object(a.useState)(null),c=Object(s.a)(n,2),o=c[0],r=c[1];return o?Object(N.jsx)(k.Provider,{value:o,children:t}):Object(N.jsx)(T,{onLogin:r})},S=function(e){var t=e.todo,n=e.handleDeleteTodo,c=e.handleUpdateTodo,o=e.isLoading,r=e.selectedId,i=e.toggleLoader,u=Object(a.useState)(!1),d=Object(s.a)(u,2),j=d[0],b=d[1],f=Object(a.useState)(t.title),p=Object(s.a)(f,2),h=p[0],m=p[1],O=Object(a.useRef)(null);Object(a.useEffect)((function(){O.current&&O.current.focus()}),[j]);var x=function(){b(!1),""===h&&n(t.id),c(t.id,{title:h})};return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)("div",{"data-cy":"Todo",className:l()("todo",{completed:t.completed}),children:[Object(N.jsx)("label",{className:"todo__status-label",children:Object(N.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",checked:t.completed,onChange:function(){c(t.id,{completed:!t.completed})}})}),j?Object(N.jsx)("form",{onSubmit:function(e){e.preventDefault(),x()},children:Object(N.jsx)("input",{"data-cy":"TodoTitleField",value:h,type:"text",ref:O,placeholder:"Empty todo will be deleted",className:"todo__title-field",onChange:function(e){return m(e.target.value)},onBlur:function(e){e.preventDefault(),x()},onKeyDown:function(e){"Escape"===e.key&&b(!1)}})}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){b(!0),m(t.title)},onBlur:function(){return b(!1)},children:t.title}),Object(N.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",onClick:function(){n(t.id)},children:"\xd7"}),r===t.id&&Object(N.jsxs)("div",{"data-cy":"TodoLoader",className:l()("modal overlay",{"is-active":o}),children:[Object(N.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(N.jsx)("div",{className:"loader"})]})]}),i&&Object(N.jsxs)("div",{"data-cy":"TodoLoader",className:l()("modal overlay",{"is-active":o}),children:[Object(N.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(N.jsx)("div",{className:"loader"})]})]})})},C=function(e){var t=e.todos,n=e.handleDeleteTodo,a=e.handleUpdateTodo,c=e.isLoading,o=e.selectedId,r=e.toggleLoader;return Object(N.jsx)("section",{className:"todoapp__main","data-cy":"TodoList",children:t.map((function(e){return Object(N.jsx)(S,{todo:e,handleDeleteTodo:n,handleUpdateTodo:a,isLoading:c,selectedId:o,toggleLoader:r},e.id)}))})};!function(e){e.ALL="All",e.ACTIVE="Active",e.COMPLETED="Completed"}(b||(b={}));var L=function(e){var t=e.todos,n=e.setFilteredTodos,a=e.handleDeleteTodo,c=t.filter((function(e){return!0===e.completed}));return Object(N.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(N.jsxs)("span",{className:"todo-count","data-cy":"todosCounter",children:[t.length-c.length," ","items left"]}),Object(N.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(N.jsx)("a",{"data-cy":"FilterLinkAll",href:"#/",className:"filter__link selected",onClick:function(){return n(b.ALL)},children:"All"}),Object(N.jsx)("a",{"data-cy":"FilterLinkActive",href:"#/active",className:"filter__link",onClick:function(){return n(b.ACTIVE)},children:"Active"}),Object(N.jsx)("a",{"data-cy":"FilterLinkCompleted",href:"#/completed",className:"filter__link",onClick:function(){return n(b.COMPLETED)},children:"Completed"})]}),Object(N.jsx)("button",{"data-cy":"ClearCompletedButton",type:"button",className:"todoapp__clear-completed",onClick:function(){t.forEach((function(e){!0===e.completed&&a(e.id)}))},children:0!==c.length&&"Clear completed"})]})},E=function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(""),i=Object(s.a)(o,2),u=i[0],d=i[1],j=Object(a.useState)(!1),O=Object(s.a)(j,2),x=O[0],v=O[1],g=Object(a.useState)(!1),y=Object(s.a)(g,2),T=y[0],_=y[1],S=Object(a.useState)(!1),E=Object(s.a)(S,2),w=E[0],D=E[1],A=Object(a.useState)(!1),F=Object(s.a)(A,2),I=F[0],U=F[1],B=Object(a.useState)(!1),P=Object(s.a)(B,2),J=P[0],R=P[1],M=Object(a.useState)(!1),V=Object(s.a)(M,2),q=V[0],H=V[1],Y=Object(a.useState)(b.ALL),G=Object(s.a)(Y,2),K=G[0],W=G[1],z=Object(a.useState)(!0),Q=Object(s.a)(z,2),X=Q[0],Z=Q[1],$=Object(a.useState)(!1),ee=Object(s.a)($,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(0),ce=Object(s.a)(ae,2),oe=ce[0],re=ce[1],se=Object(a.useContext)(k),ie=Object(a.useRef)(null);Object(a.useEffect)((function(){ie.current&&ie.current.focus()}),[]),Object(a.useEffect)((function(){var e;se&&(e=se.id,f("/todos?userId=".concat(e))).then(c)}),[]),T&&setTimeout((function(){_(!1)}),3e3);var le=function(){var e;ne(!0),v(!0),""===u&&(D(!1),_(!0),H(!0)),se&&""!==u&&(e={userId:se.id,title:u,completed:!1},p("/todos",e)).then((function(e){return c((function(t){return[].concat(Object(r.a)(t),[e])}))})).catch((function(){_(!0),H(!1),R(!1),U(!1),D(!0)})).finally((function(){d(""),v(!1),ne(!1)}))},ue=function(e){v(!0),re(e),function(e){return m("/todos/".concat(e))}(e).then((function(){return c((function(t){return t.filter((function(t){return t.id!==e}))}))})).catch((function(){_(!0),H(!1),D(!1),R(!1),U(!0)})).finally((function(){return v(!1)}))},de=function(e,t){re(e),v(!0),function(e,t){return h("/todos/".concat(e),t)}(e,t).then((function(t){c((function(n){return n.map((function(n){return n.id===e?t:n}))}))})).catch((function(){_(!0),H(!1),D(!1),U(!1),R(!0)})).finally((function(){v(!1),ne(!1)}))},je=Object(r.a)(n);switch(K){case b.ACTIVE:je=Object(r.a)(n).filter((function(e){return!1===e.completed}));break;case b.COMPLETED:je=Object(r.a)(n).filter((function(e){return!0===e.completed}));break;default:je=Object(r.a)(n)}return Object(N.jsxs)("div",{className:"todoapp",children:[Object(N.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(N.jsxs)("div",{className:"todoapp__content",children:[Object(N.jsxs)("header",{className:"todoapp__header",children:[je.length>0&&Object(N.jsx)("button",{"data-cy":"ToggleAllButton",type:"button",className:l()("todoapp__toggle-all",{active:n.every((function(e){return e.completed}))}),onClick:function(){return Z(!X),ne(!0),je.forEach((function(e){return de(e.id,{completed:X})}))}}),Object(N.jsx)("form",{onSubmit:function(e){e.preventDefault(),le()},children:Object(N.jsx)("input",{value:u,"data-cy":"NewTodoField",type:"text",ref:ie,className:"todoapp__new-todo",placeholder:"What needs to be done?",onChange:function(e){return d(e.target.value)}})})]}),Object(N.jsx)(C,{todos:je,handleDeleteTodo:ue,handleUpdateTodo:de,isLoading:x,selectedId:oe,toggleLoader:te}),n.length>0&&Object(N.jsx)(L,{todos:n,setFilteredTodos:W,handleDeleteTodo:ue})]}),T&&Object(N.jsxs)("div",{"data-cy":"ErrorNotification",className:"notification is-danger is-light has-text-weight-normal",children:[Object(N.jsx)("button",{"data-cy":"HideErrorButton",type:"button",className:"delete",onClick:function(){return _(!1)}}),q&&"Title can`t be empty",I&&"Unable to delete a todo",w&&"Unable to add a todo",J&&"Unable to update a todo"]})]})},w=function(){return Object(N.jsx)(_,{children:Object(N.jsx)(E,{})})};Object(o.createRoot)(document.getElementById("root")).render(Object(N.jsx)(w,{}))}},[[24,1,2]]]);
//# sourceMappingURL=main.1efddc4a.chunk.js.map